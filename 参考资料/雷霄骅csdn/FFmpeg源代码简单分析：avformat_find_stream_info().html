<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <link rel="canonical" href="https://blog.csdn.net/leixiaohua1020/article/details/44084321"/> 
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="referrer" content="always">
    <meta name="description" content="本文简单分析FFmpeg中一个常用的函数：avformat_find_stream_info()。该函数可以读取一部分视音频数据并且获得一些相关的信息。" />
    <meta name="keywords" content="FFmpeg,源代码" />
    <meta http-equiv="Cache-Control" content="no-siteapp" /><link rel="alternate" media="handheld" href="#" />
    <meta name="shenma-site-verification" content="5a59773ab8077d4a62bf469ab966a63b_1497598848">
    <script src="https://csdnimg.cn/release/phoenix/vendor/tingyun/tingyun-rum-blog@js"></script>

    <link href="https://csdnimg.cn/public/favicon.ico" rel="SHORTCUT ICON">
    <title>FFmpeg源代码简单分析：avformat_find_stream_info() - CSDN博客</title>
    
            <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/detail-60a2c245da.min.css">
        <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/themes/skin3-template/skin3-template-88717cedf2.min.css">

    <script type="text/javascript">
        var username = "leixiaohua1020";
        var blog_address = "https://blog.csdn.net/leixiaohua1020";
        var static_host = "https://csdnimg.cn/release/phoenix/";
        var currentUserName = ""; 
        var isShowAds = true;
        var isOwner = false;
        var loginUrl = "https://passport.csdn.net/account/login?from=https://blog.csdn.net/leixiaohua1020/article/details/44084321"
        var blogUrl = "https://blog.csdn.net/";
        var curSkin = "skin3-template";
    </script>
    <script type="text/javascript">
        // Traffic Stats of the entire Web site By baidu
        var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm@js?6bcd52f51e9b3dce32bec4a3997715ac";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
        // Traffic Stats of the entire Web site By baidu end
    </script>
    <script src="https://csdnimg.cn/public/common/libs/jquery/jquery-1.9.1.min@js" type="text/javascript"></script>
    <script src="https://csdnimg.cn/rabbit/exposure-click/main-1.0.6@js"></script>
    <!-- 新版上报 -->
    <script src="//g.csdnimg.cn/track/1.0.0/track@js" type="text/javascript"></script>
    <!-- 新版上报end -->
            <link rel="stylesheet" href="https://csdnimg.cn/public/sandalstrap/1.3/css/sandalstrap.min.css"> 
    <style>
        .MathJax, .MathJax_Message, .MathJax_Preview{
            display: none
        }
    </style>
</head>
<body>    
    <link rel="stylesheet" href="https://csdnimg.cn/public/common/toolbar/content_toolbar_css/content_toolbar.css">
    
    <script src="https://csdnimg.cn/public/sandalstrap/1.3/fonts/csdnc/csdnc@js"></script><link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/blog_code-c3a0c33d5c.css">
<link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/vendor/pagination/paging.css">
<script type="text/javascript" src="//static.mediav.com/js/mvf_news_feed@js"></script>

<header style="display: none;">
	<div class="container d-flex clearfix">
		<div class="title-box">
			<h2 class="title-blog">
				<a href="https://blog.csdn.net/leixiaohua1020">雷霄骅(leixiaohua1020)的专栏</a>
			</h2>
			<p class="description">一个广院工科生的视音频技术笔记</p>
		</div>
		<div class="opt-box d-flex justify-content-end">
			<a class="btn btn-sm" href="https://blog.csdn.net/leixiaohua1020/rss/list">
					<svg class="icon" aria-hidden="true">
						<use xlink:href="#csdnc-rss"></use>
					</svg>RSS订阅</a>
					</div>
	</div>
</header><script src="https://dup.baidustatic.com/js/ds@js"></script>
<div class="container clearfix pt0" id="mainBox">
    <main style="width: 100%;">
        <div class="blog-content-box">
	<div class="article-title-box">
			<span class="article-type type-1 float-left">原</span>		<h1 class="title-article">FFmpeg源代码简单分析：avformat_find_stream_info()</h1>
	</div>
	<div class="article-info-box">
		<div class="article-bar-top d-flex">
												<span class="time">2015年03月06日 11:15:37</span>
			<div class="float-right">
				<span class="read-count" style="display:none;">阅读数：35821</span>
											</div>
		</div>
	</div>
	<article>
		<div id="article_content" class="article_content_dummy clearfix csdn-tracking-statistics" data-pid="blog"  data-mod=popu_307  data-dsm = "post" >
                    <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/htmledit_views-0a60691e80.css" />
            <div class="htmledit_views">
                <p></p><p align="left">=====================================================</p><p align="left">FFmpeg的库函数源代码分析文章列表：</p><p align="left">【架构图】</p><p align="left"><a href="http://blog.csdn.net/leixiaohua1020/article/details/44220151"><span style="color:#0000FF;">FFmpeg</span><span style="color:#0000FF;">源代码结构图 - </span><span style="color:#0000FF;">解码</span></a></p><p align="left"><a href="http://blog.csdn.net/leixiaohua1020/article/details/44226355"><span style="color:#0000FF;">FFmpeg</span><span style="color:#0000FF;">源代码结构图 - </span><span style="color:#0000FF;">编码</span></a></p><p align="left">【通用】</p><p align="left"><a href="http://blog.csdn.net/leixiaohua1020/article/details/12677129"><span style="color:#0000FF;">FFmpeg </span><span style="color:#0000FF;">源代码简单分析：</span><span style="color:#0000FF;">av_register_all()</span></a></p><p align="left"><a href="http://blog.csdn.net/leixiaohua1020/article/details/12677265"><span style="color:#0000FF;">FFmpeg </span><span style="color:#0000FF;">源代码简单分析：</span><span style="color:#0000FF;">avcodec_register_all()</span></a></p><p align="left"><a href="http://blog.csdn.net/leixiaohua1020/article/details/41176777"><span style="color:#0000FF;">FFmpeg </span><span style="color:#0000FF;">源代码简单分析：内存的分配和释放（</span><span style="color:#0000FF;">av_malloc()</span><span style="color:#0000FF;">、</span><span style="color:#0000FF;">av_free()</span><span style="color:#0000FF;">等）</span></a></p><p align="left"><a href="http://blog.csdn.net/leixiaohua1020/article/details/41181155"><span style="color:#0000FF;">FFmpeg </span><span style="color:#0000FF;">源代码简单分析：常见结构体的初始化和销毁（</span><span style="color:#0000FF;">AVFormatContext</span><span style="color:#0000FF;">，</span><span style="color:#0000FF;">AVFrame</span><span style="color:#0000FF;">等）</span></a></p><p align="left"><a href="http://blog.csdn.net/leixiaohua1020/article/details/41199947"><span style="color:#0000FF;">FFmpeg </span><span style="color:#0000FF;">源代码简单分析：</span><span style="color:#0000FF;">avio_open2()</span></a></p><p align="left"><a href="http://blog.csdn.net/leixiaohua1020/article/details/44084557"><span style="color:#0000FF;">FFmpeg </span><span style="color:#0000FF;">源代码简单分析：</span><span style="color:#0000FF;">av_find_decoder()</span><span style="color:#0000FF;">和</span><span style="color:#0000FF;">av_find_encoder()</span></a></p><p align="left"><a href="http://blog.csdn.net/leixiaohua1020/article/details/44117891"><span style="color:#0000FF;">FFmpeg </span><span style="color:#0000FF;">源代码简单分析：</span><span style="color:#0000FF;">avcodec_open2()</span></a></p><p align="left"><a href="http://blog.csdn.net/leixiaohua1020/article/details/44206699"><span style="color:#0000FF;">FFmpeg </span><span style="color:#0000FF;">源代码简单分析：</span><span style="color:#0000FF;">avcodec_close()</span></a></p><p align="left">【解码】</p><p align="left"><a href="http://blog.csdn.net/leixiaohua1020/article/details/8661601"><span style="color:#0000FF;">图解</span><span style="color:#0000FF;">FFMPEG</span><span style="color:#0000FF;">打开媒体的函数</span><span style="color:#0000FF;">avformat_open_input</span></a></p><p align="left"><a href="http://blog.csdn.net/leixiaohua1020/article/details/44064715"><span style="color:#0000FF;">FFmpeg </span><span style="color:#0000FF;">源代码简单分析：</span><span style="color:#0000FF;">avformat_open_input()</span></a></p><p align="left"><a href="http://blog.csdn.net/leixiaohua1020/article/details/44084321"><span style="color:#0000FF;">FFmpeg </span><span style="color:#0000FF;">源代码简单分析：</span><span style="color:#0000FF;">avformat_find_stream_info()</span></a></p><p align="left"><a href="http://blog.csdn.net/leixiaohua1020/article/details/12678577"><span style="color:#0000FF;">FFmpeg </span><span style="color:#0000FF;">源代码简单分析：</span><span style="color:#0000FF;">av_read_frame()</span></a></p><p align="left"><a href="http://blog.csdn.net/leixiaohua1020/article/details/12679719"><span style="color:#0000FF;">FFmpeg </span><span style="color:#0000FF;">源代码简单分析：</span><span style="color:#0000FF;">avcodec_decode_video2()</span></a></p><p align="left"><a href="http://blog.csdn.net/leixiaohua1020/article/details/44110683"><span style="color:#0000FF;">FFmpeg </span><span style="color:#0000FF;">源代码简单分析：</span><span style="color:#0000FF;">avformat_close_input()</span></a></p><p align="left">【编码】</p><p align="left"><a href="http://blog.csdn.net/leixiaohua1020/article/details/41198929"><span style="color:#0000FF;">FFmpeg </span><span style="color:#0000FF;">源代码简单分析：</span><span style="color:#0000FF;">avformat_alloc_output_context2()</span></a></p><p align="left"><a href="http://blog.csdn.net/leixiaohua1020/article/details/44116215"><span style="color:#0000FF;">FFmpeg </span><span style="color:#0000FF;">源代码简单分析：</span><span style="color:#0000FF;">avformat_write_header()</span></a></p><p align="left"><a href="http://blog.csdn.net/leixiaohua1020/article/details/44206485"><span style="color:#0000FF;">FFmpeg </span><span style="color:#0000FF;">源代码简单分析：</span><span style="color:#0000FF;">avcodec_encode_video()</span></a></p><p align="left"><a href="http://blog.csdn.net/leixiaohua1020/article/details/44199673"><span style="color:#0000FF;">FFmpeg </span><span style="color:#0000FF;">源代码简单分析：</span><span style="color:#0000FF;">av_write_frame()</span></a></p><p align="left"><a href="http://blog.csdn.net/leixiaohua1020/article/details/44201645"><span style="color:#0000FF;">FFmpeg </span><span style="color:#0000FF;">源代码简单分析：</span><span style="color:#0000FF;">av_write_trailer()</span></a></p><p align="left">【其它】</p><p align="left"><a href="http://blog.csdn.net/leixiaohua1020/article/details/44243155"><span style="color:#0000FF;">FFmpeg</span><span style="color:#0000FF;">源代码简单分析：日志输出系统（</span><span style="color:#0000FF;">av_log()</span><span style="color:#0000FF;">等）</span></a></p><p align="left"><a href="http://blog.csdn.net/leixiaohua1020/article/details/44268323"><span style="color:#0000FF;">FFmpeg</span><span style="color:#0000FF;">源代码简单分析：结构体成员管理系统</span><span style="color:#0000FF;">-AVClass</span></a></p><p align="left"><a href="http://blog.csdn.net/leixiaohua1020/article/details/44279329"><span style="color:#0000FF;">FFmpeg</span><span style="color:#0000FF;">源代码简单分析：结构体成员管理系统</span><span style="color:#0000FF;">-AVOption</span></a></p><p align="left"><a href="http://blog.csdn.net/leixiaohua1020/article/details/44305697"><span style="color:#0000FF;">FFmpeg</span><span style="color:#0000FF;">源代码简单分析：</span><span style="color:#0000FF;">libswscale</span><span style="color:#0000FF;">的</span><span style="color:#0000FF;">sws_getContext()</span></a></p><p align="left"><a href="http://blog.csdn.net/leixiaohua1020/article/details/44346687"><span style="color:#0000FF;">FFmpeg</span><span style="color:#0000FF;">源代码简单分析：</span><span style="color:#0000FF;">libswscale</span><span style="color:#0000FF;">的</span><span style="color:#0000FF;">sws_scale()</span></a></p><p align="left"><a href="http://blog.csdn.net/leixiaohua1020/article/details/41211121"><span style="color:#0000FF;">FFmpeg</span><span style="color:#0000FF;">源代码简单分析：</span><span style="color:#0000FF;">libavdevice</span><span style="color:#0000FF;">的</span><span style="color:#0000FF;">avdevice_register_all()</span></a></p><p align="left"><a href="http://blog.csdn.net/leixiaohua1020/article/details/44597955"><span style="color:#0000FF;">FFmpeg</span><span style="color:#0000FF;">源代码简单分析：</span><span style="color:#0000FF;">libavdevice</span><span style="color:#0000FF;">的</span><span style="color:#0000FF;">gdigrab</span></a></p><p align="left">【脚本】</p><p align="left"><a href="http://blog.csdn.net/leixiaohua1020/article/details/44556525"><span style="color:#0000FF;">FFmpeg</span><span style="color:#0000FF;">源代码简单分析：</span><span style="color:#0000FF;">makefile</span></a></p><p align="left"><a href="http://blog.csdn.net/leixiaohua1020/article/details/44587465"><span style="color:#0000FF;">FFmpeg</span><span style="color:#0000FF;">源代码简单分析：</span><span style="color:#0000FF;">configure</span></a></p><p align="left">【H.264】</p><p align="left"><a href="http://blog.csdn.net/leixiaohua1020/article/details/44864509"><span style="color:#0000FF;">FFmpeg</span><span style="color:#0000FF;">的</span><span style="color:#0000FF;">H.264</span><span style="color:#0000FF;">解码器源代码简单分析：概述</span></a></p><p align="left">=====================================================</p><br /><p>本文简单分析FFmpeg中一个常用的函数：avformat_find_stream_info()。该函数可以读取一部分视音频数据并且获得一些相关的信息。avformat_find_stream_info()的声明位于libavformat\avformat.h，如下所示。 </p><pre class="cpp">/**
 * Read packets of a media file to get stream information. This
 * is useful for file formats with no headers such as MPEG. This
 * function also computes the real framerate in case of MPEG-2 repeat
 * frame mode.
 * The logical file position is not changed by this function;
 * examined packets may be buffered for later processing.
 *
 * @param ic media file handle
 * @param options  If non-NULL, an ic.nb_streams long array of pointers to
 *                 dictionaries, where i-th member contains options for
 *                 codec corresponding to i-th stream.
 *                 On return each dictionary will be filled with options that were not found.
 * @return &gt;=0 if OK, AVERROR_xxx on error
 *
 * @note this function isn't guaranteed to open all the codecs, so
 *       options being non-empty at return is a perfectly normal behavior.
 *
 * @todo Let the user decide somehow what information is needed so that
 *       we do not waste time getting stuff the user does not need.
 */
int avformat_find_stream_info(AVFormatContext *ic, AVDictionary **options);</pre><br />简单解释一下它的参数的含义：<br /><blockquote style="margin:0 0 0 40px;border:none;padding:0px;">ic：输入的AVFormatContext。<br />options：额外的选项，目前没有深入研究过。</blockquote>函数正常执行后返回值大于等于0。<br />该函数最典型的例子可以参考：<a href="http://blog.csdn.net/leixiaohua1020/article/details/38868499">最简单的基于FFMPEG+SDL的视频播放器 ver2 （采用SDL2.0）</a><br /><br /><p>PS：由于该函数比较复杂，所以只看了一部分代码，以后有时间再进一步分析。</p><h2>函数调用关系图</h2>函数的调用关系如下图所示。<br /><div style="text-align:center;"><img src="https://img-blog.csdn.net/20150306173746865" alt="" /><br /></div><div style="text-align:center;"><br /></div><h2>avformat_find_stream_info()</h2>avformat_find_stream_info()的定义位于libavformat\utils.c。它的代码比较长，如下所示。<br /><pre class="cpp">int avformat_find_stream_info(AVFormatContext *ic, AVDictionary **options)
{
    int i, count, ret = 0, j;
    int64_t read_size;
    AVStream *st;
    AVPacket pkt1, *pkt;
    int64_t old_offset  = avio_tell(ic-&gt;pb);
    // new streams might appear, no options for those
    int orig_nb_streams = ic-&gt;nb_streams;
    int flush_codecs;
    int64_t max_analyze_duration = ic-&gt;max_analyze_duration2;
    int64_t probesize = ic-&gt;probesize2;


    if (!max_analyze_duration)
        max_analyze_duration = ic-&gt;max_analyze_duration;
    if (ic-&gt;probesize)
        probesize = ic-&gt;probesize;
    flush_codecs = probesize &gt; 0;


    av_opt_set(ic, "skip_clear", "1", AV_OPT_SEARCH_CHILDREN);


    if (!max_analyze_duration) {
        if (!strcmp(ic-&gt;iformat-&gt;name, "flv") &amp;&amp; !(ic-&gt;ctx_flags &amp; AVFMTCTX_NOHEADER)) {
            max_analyze_duration = 10*AV_TIME_BASE;
        } else
            max_analyze_duration = 5*AV_TIME_BASE;
    }


    if (ic-&gt;pb)
        av_log(ic, AV_LOG_DEBUG, "Before avformat_find_stream_info() pos: %"PRId64" bytes read:%"PRId64" seeks:%d\n",
               avio_tell(ic-&gt;pb), ic-&gt;pb-&gt;bytes_read, ic-&gt;pb-&gt;seek_count);


    for (i = 0; i &lt; ic-&gt;nb_streams; i++) {
        const AVCodec *codec;
        AVDictionary *thread_opt = NULL;
        st = ic-&gt;streams[i];


        if (st-&gt;codec-&gt;codec_type == AVMEDIA_TYPE_VIDEO ||
            st-&gt;codec-&gt;codec_type == AVMEDIA_TYPE_SUBTITLE) {
/*            if (!st-&gt;time_base.num)
                st-&gt;time_base = */
            if (!st-&gt;codec-&gt;time_base.num)
                st-&gt;codec-&gt;time_base = st-&gt;time_base;
        }
        // only for the split stuff
        if (!st-&gt;parser &amp;&amp; !(ic-&gt;flags &amp; AVFMT_FLAG_NOPARSE)) {
            st-&gt;parser = av_parser_init(st-&gt;codec-&gt;codec_id);
            if (st-&gt;parser) {
                if (st-&gt;need_parsing == AVSTREAM_PARSE_HEADERS) {
                    st-&gt;parser-&gt;flags |= PARSER_FLAG_COMPLETE_FRAMES;
                } else if (st-&gt;need_parsing == AVSTREAM_PARSE_FULL_RAW) {
                    st-&gt;parser-&gt;flags |= PARSER_FLAG_USE_CODEC_TS;
                }
            } else if (st-&gt;need_parsing) {
                av_log(ic, AV_LOG_VERBOSE, "parser not found for codec "
                       "%s, packets or times may be invalid.\n",
                       avcodec_get_name(st-&gt;codec-&gt;codec_id));
            }
        }
        codec = find_decoder(ic, st, st-&gt;codec-&gt;codec_id);


        /* Force thread count to 1 since the H.264 decoder will not extract
         * SPS and PPS to extradata during multi-threaded decoding. */
        av_dict_set(options ? &amp;options[i] : &amp;thread_opt, "threads", "1", 0);


        if (ic-&gt;codec_whitelist)
            av_dict_set(options ? &amp;options[i] : &amp;thread_opt, "codec_whitelist", ic-&gt;codec_whitelist, 0);


        /* Ensure that subtitle_header is properly set. */
        if (st-&gt;codec-&gt;codec_type == AVMEDIA_TYPE_SUBTITLE
            &amp;&amp; codec &amp;&amp; !st-&gt;codec-&gt;codec) {
            if (avcodec_open2(st-&gt;codec, codec, options ? &amp;options[i] : &amp;thread_opt) &lt; 0)
                av_log(ic, AV_LOG_WARNING,
                       "Failed to open codec in av_find_stream_info\n");
        }


        // Try to just open decoders, in case this is enough to get parameters.
        if (!has_codec_parameters(st, NULL) &amp;&amp; st-&gt;request_probe &lt;= 0) {
            if (codec &amp;&amp; !st-&gt;codec-&gt;codec)
                if (avcodec_open2(st-&gt;codec, codec, options ? &amp;options[i] : &amp;thread_opt) &lt; 0)
                    av_log(ic, AV_LOG_WARNING,
                           "Failed to open codec in av_find_stream_info\n");
        }
        if (!options)
            av_dict_free(&amp;thread_opt);
    }


    for (i = 0; i &lt; ic-&gt;nb_streams; i++) {
#if FF_API_R_FRAME_RATE
        ic-&gt;streams[i]-&gt;info-&gt;last_dts = AV_NOPTS_VALUE;
#endif
        ic-&gt;streams[i]-&gt;info-&gt;fps_first_dts = AV_NOPTS_VALUE;
        ic-&gt;streams[i]-&gt;info-&gt;fps_last_dts  = AV_NOPTS_VALUE;
    }


    count     = 0;
    read_size = 0;
    for (;;) {
        if (ff_check_interrupt(&amp;ic-&gt;interrupt_callback)) {
            ret = AVERROR_EXIT;
            av_log(ic, AV_LOG_DEBUG, "interrupted\n");
            break;
        }


        /* check if one codec still needs to be handled */
        for (i = 0; i &lt; ic-&gt;nb_streams; i++) {
            int fps_analyze_framecount = 20;


            st = ic-&gt;streams[i];
            if (!has_codec_parameters(st, NULL))
                break;
            /* If the timebase is coarse (like the usual millisecond precision
             * of mkv), we need to analyze more frames to reliably arrive at
             * the correct fps. */
            if (av_q2d(st-&gt;time_base) &gt; 0.0005)
                fps_analyze_framecount *= 2;
            if (!tb_unreliable(st-&gt;codec))
                fps_analyze_framecount = 0;
            if (ic-&gt;fps_probe_size &gt;= 0)
                fps_analyze_framecount = ic-&gt;fps_probe_size;
            if (st-&gt;disposition &amp; AV_DISPOSITION_ATTACHED_PIC)
                fps_analyze_framecount = 0;
            /* variable fps and no guess at the real fps */
            if (!(st-&gt;r_frame_rate.num &amp;&amp; st-&gt;avg_frame_rate.num) &amp;&amp;
                st-&gt;info-&gt;duration_count &lt; fps_analyze_framecount &amp;&amp;
                st-&gt;codec-&gt;codec_type == AVMEDIA_TYPE_VIDEO)
                break;
            if (st-&gt;parser &amp;&amp; st-&gt;parser-&gt;parser-&gt;split &amp;&amp;
                !st-&gt;codec-&gt;extradata)
                break;
            if (st-&gt;first_dts == AV_NOPTS_VALUE &amp;&amp;
                !(ic-&gt;iformat-&gt;flags &amp; AVFMT_NOTIMESTAMPS) &amp;&amp;
                st-&gt;codec_info_nb_frames &lt; ic-&gt;max_ts_probe &amp;&amp;
                (st-&gt;codec-&gt;codec_type == AVMEDIA_TYPE_VIDEO ||
                 st-&gt;codec-&gt;codec_type == AVMEDIA_TYPE_AUDIO))
                break;
        }
        if (i == ic-&gt;nb_streams) {
            /* NOTE: If the format has no header, then we need to read some
             * packets to get most of the streams, so we cannot stop here. */
            if (!(ic-&gt;ctx_flags &amp; AVFMTCTX_NOHEADER)) {
                /* If we found the info for all the codecs, we can stop. */
                ret = count;
                av_log(ic, AV_LOG_DEBUG, "All info found\n");
                flush_codecs = 0;
                break;
            }
        }
        /* We did not get all the codec info, but we read too much data. */
        if (read_size &gt;= probesize) {
            ret = count;
            av_log(ic, AV_LOG_DEBUG,
                   "Probe buffer size limit of %"PRId64" bytes reached\n", probesize);
            for (i = 0; i &lt; ic-&gt;nb_streams; i++)
                if (!ic-&gt;streams[i]-&gt;r_frame_rate.num &amp;&amp;
                    ic-&gt;streams[i]-&gt;info-&gt;duration_count &lt;= 1 &amp;&amp;
                    ic-&gt;streams[i]-&gt;codec-&gt;codec_type == AVMEDIA_TYPE_VIDEO &amp;&amp;
                    strcmp(ic-&gt;iformat-&gt;name, "image2"))
                    av_log(ic, AV_LOG_WARNING,
                           "Stream #%d: not enough frames to estimate rate; "
                           "consider increasing probesize\n", i);
            break;
        }


        /* NOTE: A new stream can be added there if no header in file
         * (AVFMTCTX_NOHEADER). */
        ret = read_frame_internal(ic, &amp;pkt1);
        if (ret == AVERROR(EAGAIN))
            continue;


        if (ret &lt; 0) {
            /* EOF or error*/
            break;
        }


        if (ic-&gt;flags &amp; AVFMT_FLAG_NOBUFFER)
            free_packet_buffer(&amp;ic-&gt;packet_buffer, &amp;ic-&gt;packet_buffer_end);
        {
            pkt = add_to_pktbuf(&amp;ic-&gt;packet_buffer, &amp;pkt1,
                                &amp;ic-&gt;packet_buffer_end);
            if (!pkt) {
                ret = AVERROR(ENOMEM);
                goto find_stream_info_err;
            }
            if ((ret = av_dup_packet(pkt)) &lt; 0)
                goto find_stream_info_err;
        }


        st = ic-&gt;streams[pkt-&gt;stream_index];
        if (!(st-&gt;disposition &amp; AV_DISPOSITION_ATTACHED_PIC))
            read_size += pkt-&gt;size;


        if (pkt-&gt;dts != AV_NOPTS_VALUE &amp;&amp; st-&gt;codec_info_nb_frames &gt; 1) {
            /* check for non-increasing dts */
            if (st-&gt;info-&gt;fps_last_dts != AV_NOPTS_VALUE &amp;&amp;
                st-&gt;info-&gt;fps_last_dts &gt;= pkt-&gt;dts) {
                av_log(ic, AV_LOG_DEBUG,
                       "Non-increasing DTS in stream %d: packet %d with DTS "
                       "%"PRId64", packet %d with DTS %"PRId64"\n",
                       st-&gt;index, st-&gt;info-&gt;fps_last_dts_idx,
                       st-&gt;info-&gt;fps_last_dts, st-&gt;codec_info_nb_frames,
                       pkt-&gt;dts);
                st-&gt;info-&gt;fps_first_dts =
                st-&gt;info-&gt;fps_last_dts  = AV_NOPTS_VALUE;
            }
            /* Check for a discontinuity in dts. If the difference in dts
             * is more than 1000 times the average packet duration in the
             * sequence, we treat it as a discontinuity. */
            if (st-&gt;info-&gt;fps_last_dts != AV_NOPTS_VALUE &amp;&amp;
                st-&gt;info-&gt;fps_last_dts_idx &gt; st-&gt;info-&gt;fps_first_dts_idx &amp;&amp;
                (pkt-&gt;dts - st-&gt;info-&gt;fps_last_dts) / 1000 &gt;
                (st-&gt;info-&gt;fps_last_dts     - st-&gt;info-&gt;fps_first_dts) /
                (st-&gt;info-&gt;fps_last_dts_idx - st-&gt;info-&gt;fps_first_dts_idx)) {
                av_log(ic, AV_LOG_WARNING,
                       "DTS discontinuity in stream %d: packet %d with DTS "
                       "%"PRId64", packet %d with DTS %"PRId64"\n",
                       st-&gt;index, st-&gt;info-&gt;fps_last_dts_idx,
                       st-&gt;info-&gt;fps_last_dts, st-&gt;codec_info_nb_frames,
                       pkt-&gt;dts);
                st-&gt;info-&gt;fps_first_dts =
                st-&gt;info-&gt;fps_last_dts  = AV_NOPTS_VALUE;
            }


            /* update stored dts values */
            if (st-&gt;info-&gt;fps_first_dts == AV_NOPTS_VALUE) {
                st-&gt;info-&gt;fps_first_dts     = pkt-&gt;dts;
                st-&gt;info-&gt;fps_first_dts_idx = st-&gt;codec_info_nb_frames;
            }
            st-&gt;info-&gt;fps_last_dts     = pkt-&gt;dts;
            st-&gt;info-&gt;fps_last_dts_idx = st-&gt;codec_info_nb_frames;
        }
        if (st-&gt;codec_info_nb_frames&gt;1) {
            int64_t t = 0;


            if (st-&gt;time_base.den &gt; 0)
                t = av_rescale_q(st-&gt;info-&gt;codec_info_duration, st-&gt;time_base, AV_TIME_BASE_Q);
            if (st-&gt;avg_frame_rate.num &gt; 0)
                t = FFMAX(t, av_rescale_q(st-&gt;codec_info_nb_frames, av_inv_q(st-&gt;avg_frame_rate), AV_TIME_BASE_Q));


            if (   t == 0
                &amp;&amp; st-&gt;codec_info_nb_frames&gt;30
                &amp;&amp; st-&gt;info-&gt;fps_first_dts != AV_NOPTS_VALUE
                &amp;&amp; st-&gt;info-&gt;fps_last_dts  != AV_NOPTS_VALUE)
                t = FFMAX(t, av_rescale_q(st-&gt;info-&gt;fps_last_dts - st-&gt;info-&gt;fps_first_dts, st-&gt;time_base, AV_TIME_BASE_Q));


            if (t &gt;= max_analyze_duration) {
                av_log(ic, AV_LOG_VERBOSE, "max_analyze_duration %"PRId64" reached at %"PRId64" microseconds\n",
                       max_analyze_duration,
                       t);
                if (ic-&gt;flags &amp; AVFMT_FLAG_NOBUFFER)
                    av_packet_unref(pkt);
                break;
            }
            if (pkt-&gt;duration) {
                st-&gt;info-&gt;codec_info_duration        += pkt-&gt;duration;
                st-&gt;info-&gt;codec_info_duration_fields += st-&gt;parser &amp;&amp; st-&gt;need_parsing &amp;&amp; st-&gt;codec-&gt;ticks_per_frame ==2 ? st-&gt;parser-&gt;repeat_pict + 1 : 2;
            }
        }
#if FF_API_R_FRAME_RATE
        if (st-&gt;codec-&gt;codec_type == AVMEDIA_TYPE_VIDEO)
            ff_rfps_add_frame(ic, st, pkt-&gt;dts);
#endif
        if (st-&gt;parser &amp;&amp; st-&gt;parser-&gt;parser-&gt;split &amp;&amp; !st-&gt;codec-&gt;extradata) {
            int i = st-&gt;parser-&gt;parser-&gt;split(st-&gt;codec, pkt-&gt;data, pkt-&gt;size);
            if (i &gt; 0 &amp;&amp; i &lt; FF_MAX_EXTRADATA_SIZE) {
                if (ff_alloc_extradata(st-&gt;codec, i))
                    return AVERROR(ENOMEM);
                memcpy(st-&gt;codec-&gt;extradata, pkt-&gt;data,
                       st-&gt;codec-&gt;extradata_size);
            }
        }


        /* If still no information, we try to open the codec and to
         * decompress the frame. We try to avoid that in most cases as
         * it takes longer and uses more memory. For MPEG-4, we need to
         * decompress for QuickTime.
         *
         * If CODEC_CAP_CHANNEL_CONF is set this will force decoding of at
         * least one frame of codec data, this makes sure the codec initializes
         * the channel configuration and does not only trust the values from
         * the container. */
        try_decode_frame(ic, st, pkt,
                         (options &amp;&amp; i &lt; orig_nb_streams) ? &amp;options[i] : NULL);


        if (ic-&gt;flags &amp; AVFMT_FLAG_NOBUFFER)
            av_packet_unref(pkt);


        st-&gt;codec_info_nb_frames++;
        count++;
    }


    if (flush_codecs) {
        AVPacket empty_pkt = { 0 };
        int err = 0;
        av_init_packet(&amp;empty_pkt);


        for (i = 0; i &lt; ic-&gt;nb_streams; i++) {


            st = ic-&gt;streams[i];


            /* flush the decoders */
            if (st-&gt;info-&gt;found_decoder == 1) {
                do {
                    err = try_decode_frame(ic, st, &amp;empty_pkt,
                                            (options &amp;&amp; i &lt; orig_nb_streams)
                                            ? &amp;options[i] : NULL);
                } while (err &gt; 0 &amp;&amp; !has_codec_parameters(st, NULL));


                if (err &lt; 0) {
                    av_log(ic, AV_LOG_INFO,
                        "decoding for stream %d failed\n", st-&gt;index);
                }
            }
        }
    }


    // close codecs which were opened in try_decode_frame()
    for (i = 0; i &lt; ic-&gt;nb_streams; i++) {
        st = ic-&gt;streams[i];
        avcodec_close(st-&gt;codec);
    }


    ff_rfps_calculate(ic);


    for (i = 0; i &lt; ic-&gt;nb_streams; i++) {
        st = ic-&gt;streams[i];
        if (st-&gt;codec-&gt;codec_type == AVMEDIA_TYPE_VIDEO) {
            if (st-&gt;codec-&gt;codec_id == AV_CODEC_ID_RAWVIDEO &amp;&amp; !st-&gt;codec-&gt;codec_tag &amp;&amp; !st-&gt;codec-&gt;bits_per_coded_sample) {
                uint32_t tag= avcodec_pix_fmt_to_codec_tag(st-&gt;codec-&gt;pix_fmt);
                if (avpriv_find_pix_fmt(avpriv_get_raw_pix_fmt_tags(), tag) == st-&gt;codec-&gt;pix_fmt)
                    st-&gt;codec-&gt;codec_tag= tag;
            }


            /* estimate average framerate if not set by demuxer */
            if (st-&gt;info-&gt;codec_info_duration_fields &amp;&amp;
                !st-&gt;avg_frame_rate.num &amp;&amp;
                st-&gt;info-&gt;codec_info_duration) {
                int best_fps      = 0;
                double best_error = 0.01;


                if (st-&gt;info-&gt;codec_info_duration        &gt;= INT64_MAX / st-&gt;time_base.num / 2||
                    st-&gt;info-&gt;codec_info_duration_fields &gt;= INT64_MAX / st-&gt;time_base.den ||
                    st-&gt;info-&gt;codec_info_duration        &lt; 0)
                    continue;
                av_reduce(&amp;st-&gt;avg_frame_rate.num, &amp;st-&gt;avg_frame_rate.den,
                          st-&gt;info-&gt;codec_info_duration_fields * (int64_t) st-&gt;time_base.den,
                          st-&gt;info-&gt;codec_info_duration * 2 * (int64_t) st-&gt;time_base.num, 60000);


                /* Round guessed framerate to a "standard" framerate if it's
                 * within 1% of the original estimate. */
                for (j = 0; j &lt; MAX_STD_TIMEBASES; j++) {
                    AVRational std_fps = { get_std_framerate(j), 12 * 1001 };
                    double error       = fabs(av_q2d(st-&gt;avg_frame_rate) /
                                              av_q2d(std_fps) - 1);


                    if (error &lt; best_error) {
                        best_error = error;
                        best_fps   = std_fps.num;
                    }
                }
                if (best_fps)
                    av_reduce(&amp;st-&gt;avg_frame_rate.num, &amp;st-&gt;avg_frame_rate.den,
                              best_fps, 12 * 1001, INT_MAX);
            }


            if (!st-&gt;r_frame_rate.num) {
                if (    st-&gt;codec-&gt;time_base.den * (int64_t) st-&gt;time_base.num
                    &lt;= st-&gt;codec-&gt;time_base.num * st-&gt;codec-&gt;ticks_per_frame * (int64_t) st-&gt;time_base.den) {
                    st-&gt;r_frame_rate.num = st-&gt;codec-&gt;time_base.den;
                    st-&gt;r_frame_rate.den = st-&gt;codec-&gt;time_base.num * st-&gt;codec-&gt;ticks_per_frame;
                } else {
                    st-&gt;r_frame_rate.num = st-&gt;time_base.den;
                    st-&gt;r_frame_rate.den = st-&gt;time_base.num;
                }
            }
        } else if (st-&gt;codec-&gt;codec_type == AVMEDIA_TYPE_AUDIO) {
            if (!st-&gt;codec-&gt;bits_per_coded_sample)
                st-&gt;codec-&gt;bits_per_coded_sample =
                    av_get_bits_per_sample(st-&gt;codec-&gt;codec_id);
            // set stream disposition based on audio service type
            switch (st-&gt;codec-&gt;audio_service_type) {
            case AV_AUDIO_SERVICE_TYPE_EFFECTS:
                st-&gt;disposition = AV_DISPOSITION_CLEAN_EFFECTS;
                break;
            case AV_AUDIO_SERVICE_TYPE_VISUALLY_IMPAIRED:
                st-&gt;disposition = AV_DISPOSITION_VISUAL_IMPAIRED;
                break;
            case AV_AUDIO_SERVICE_TYPE_HEARING_IMPAIRED:
                st-&gt;disposition = AV_DISPOSITION_HEARING_IMPAIRED;
                break;
            case AV_AUDIO_SERVICE_TYPE_COMMENTARY:
                st-&gt;disposition = AV_DISPOSITION_COMMENT;
                break;
            case AV_AUDIO_SERVICE_TYPE_KARAOKE:
                st-&gt;disposition = AV_DISPOSITION_KARAOKE;
                break;
            }
        }
    }


    if (probesize)
    estimate_timings(ic, old_offset);


    av_opt_set(ic, "skip_clear", "0", AV_OPT_SEARCH_CHILDREN);


    if (ret &gt;= 0 &amp;&amp; ic-&gt;nb_streams)
        /* We could not have all the codec parameters before EOF. */
        ret = -1;
    for (i = 0; i &lt; ic-&gt;nb_streams; i++) {
        const char *errmsg;
        st = ic-&gt;streams[i];
        if (!has_codec_parameters(st, &amp;errmsg)) {
            char buf[256];
            avcodec_string(buf, sizeof(buf), st-&gt;codec, 0);
            av_log(ic, AV_LOG_WARNING,
                   "Could not find codec parameters for stream %d (%s): %s\n"
                   "Consider increasing the value for the 'analyzeduration' and 'probesize' options\n",
                   i, buf, errmsg);
        } else {
            ret = 0;
        }
    }


    compute_chapters_end(ic);


find_stream_info_err:
    for (i = 0; i &lt; ic-&gt;nb_streams; i++) {
        st = ic-&gt;streams[i];
        if (ic-&gt;streams[i]-&gt;codec-&gt;codec_type != AVMEDIA_TYPE_AUDIO)
            ic-&gt;streams[i]-&gt;codec-&gt;thread_count = 0;
        if (st-&gt;info)
            av_freep(&amp;st-&gt;info-&gt;duration_error);
        av_freep(&amp;ic-&gt;streams[i]-&gt;info);
    }
    if (ic-&gt;pb)
        av_log(ic, AV_LOG_DEBUG, "After avformat_find_stream_info() pos: %"PRId64" bytes read:%"PRId64" seeks:%d frames:%d\n",
               avio_tell(ic-&gt;pb), ic-&gt;pb-&gt;bytes_read, ic-&gt;pb-&gt;seek_count, count);
    return ret;
}</pre><br />由于avformat_find_stream_info()代码比较长，难以全部分析，在这里只能简单记录一下它的要点。该函数主要用于给每个媒体流（音频/视频）的AVStream结构体赋值。我们大致浏览一下这个函数的代码，会发现它其实已经实现了解码器的查找，解码器的打开，视音频帧的读取，视音频帧的解码等工作。换句话说，该函数实际上已经“走通”的解码的整个流程。下面看一下除了成员变量赋值之外，该函数的几个关键流程。<br /><blockquote style="margin:0 0 0 40px;border:none;padding:0px;"></blockquote><blockquote style="margin:0 0 0 40px;border:none;padding:0px;">1.查找解码器：find_decoder()<br />2.打开解码器：avcodec_open2()<br />3.读取完整的一帧压缩编码的数据：read_frame_internal()<br /><span style="font-family:'FangSong_GB2312';">注：av_read_frame()内部实际上就是调用的read_frame_internal()。</span><br />4.解码一些压缩编码数据：try_decode_frame()</blockquote><blockquote style="margin:0 0 0 40px;border:none;padding:0px;"></blockquote><blockquote style="margin:0 0 0 40px;border:none;padding:0px;"></blockquote><blockquote style="margin:0 0 0 40px;border:none;padding:0px;"></blockquote>下面选择上述流程中几个关键函数的代码简单看一下。<br /><br /><h2>find_decoder()</h2>find_decoder()用于找到合适的解码器，它的定义如下所示。<br /><pre class="cpp">static const AVCodec *find_decoder(AVFormatContext *s, AVStream *st, enum AVCodecID codec_id)
{
    if (st-&gt;codec-&gt;codec)
        return st-&gt;codec-&gt;codec;


    switch (st-&gt;codec-&gt;codec_type) {
    case AVMEDIA_TYPE_VIDEO:
        if (s-&gt;video_codec)    return s-&gt;video_codec;
        break;
    case AVMEDIA_TYPE_AUDIO:
        if (s-&gt;audio_codec)    return s-&gt;audio_codec;
        break;
    case AVMEDIA_TYPE_SUBTITLE:
        if (s-&gt;subtitle_codec) return s-&gt;subtitle_codec;
        break;
    }


    return avcodec_find_decoder(codec_id);
}</pre><br />从代码中可以看出，如果指定的AVStream已经包含了解码器，则函数什么也不做直接返回。否则调用avcodec_find_decoder()获取解码器。avcodec_find_decoder()是一个FFmpeg的API函数，在这里不做详细分析。<br /><br /><h2>read_frame_internal()</h2><p>read_frame_internal()的功能是读取一帧压缩码流数据。FFmpeg的API函数av_read_frame()内部调用的就是read_frame_internal()。有关这方面的知识可以参考文章：</p><a href="http://blog.csdn.net/leixiaohua1020/article/details/12678577">ffmpeg 源代码简单分析 ： av_read_frame()</a><br />因此，可以认为read_frame_internal()和av_read_frame()的功能基本上是等同的。<br /><br /><h2>try_decode_frame()</h2>try_decode_frame()的功能可以从字面上的意思进行理解：“尝试解码一些帧”，它的定义如下所示。<br /><pre class="cpp">/* returns 1 or 0 if or if not decoded data was returned, or a negative error */
static int try_decode_frame(AVFormatContext *s, AVStream *st, AVPacket *avpkt,
                            AVDictionary **options)
{
    const AVCodec *codec;
    int got_picture = 1, ret = 0;
    AVFrame *frame = av_frame_alloc();
    AVSubtitle subtitle;
    AVPacket pkt = *avpkt;


    if (!frame)
        return AVERROR(ENOMEM);


    if (!avcodec_is_open(st-&gt;codec) &amp;&amp;
        st-&gt;info-&gt;found_decoder &lt;= 0 &amp;&amp;
        (st-&gt;codec-&gt;codec_id != -st-&gt;info-&gt;found_decoder || !st-&gt;codec-&gt;codec_id)) {
        AVDictionary *thread_opt = NULL;


        codec = find_decoder(s, st, st-&gt;codec-&gt;codec_id);


        if (!codec) {
            st-&gt;info-&gt;found_decoder = -st-&gt;codec-&gt;codec_id;
            ret                     = -1;
            goto fail;
        }


        /* Force thread count to 1 since the H.264 decoder will not extract
         * SPS and PPS to extradata during multi-threaded decoding. */
        av_dict_set(options ? options : &amp;thread_opt, "threads", "1", 0);
        if (s-&gt;codec_whitelist)
            av_dict_set(options ? options : &amp;thread_opt, "codec_whitelist", s-&gt;codec_whitelist, 0);
        ret = avcodec_open2(st-&gt;codec, codec, options ? options : &amp;thread_opt);
        if (!options)
            av_dict_free(&amp;thread_opt);
        if (ret &lt; 0) {
            st-&gt;info-&gt;found_decoder = -st-&gt;codec-&gt;codec_id;
            goto fail;
        }
        st-&gt;info-&gt;found_decoder = 1;
    } else if (!st-&gt;info-&gt;found_decoder)
        st-&gt;info-&gt;found_decoder = 1;


    if (st-&gt;info-&gt;found_decoder &lt; 0) {
        ret = -1;
        goto fail;
    }


    while ((pkt.size &gt; 0 || (!pkt.data &amp;&amp; got_picture)) &amp;&amp;
           ret &gt;= 0 &amp;&amp;
           (!has_codec_parameters(st, NULL) || !has_decode_delay_been_guessed(st) ||
            (!st-&gt;codec_info_nb_frames &amp;&amp;
             st-&gt;codec-&gt;codec-&gt;capabilities &amp; CODEC_CAP_CHANNEL_CONF))) {
        got_picture = 0;
        switch (st-&gt;codec-&gt;codec_type) {
        case AVMEDIA_TYPE_VIDEO:
            ret = avcodec_decode_video2(st-&gt;codec, frame,
                                        &amp;got_picture, &amp;pkt);
            break;
        case AVMEDIA_TYPE_AUDIO:
            ret = avcodec_decode_audio4(st-&gt;codec, frame, &amp;got_picture, &amp;pkt);
            break;
        case AVMEDIA_TYPE_SUBTITLE:
            ret = avcodec_decode_subtitle2(st-&gt;codec, &amp;subtitle,
                                           &amp;got_picture, &amp;pkt);
            ret = pkt.size;
            break;
        default:
            break;
        }
        if (ret &gt;= 0) {
            if (got_picture)
                st-&gt;nb_decoded_frames++;
            pkt.data += ret;
            pkt.size -= ret;
            ret       = got_picture;
        }
    }


    if (!pkt.data &amp;&amp; !got_picture)
        ret = -1;


fail:
    av_frame_free(&amp;frame);
    return ret;
}</pre><br />从try_decode_frame()的定义可以看出，该函数首先判断视音频流的解码器是否已经打开，如果没有打开的话，先打开相应的解码器。接下来根据视音频流类型的不同，调用不同的解码函数进行解码：视频流调用avcodec_decode_video2()，音频流调用avcodec_decode_audio4()，字幕流调用avcodec_decode_subtitle2()。解码的循环会一直持续下去直到满足了while()的所有条件。<br /><p>while()语句的条件中有一个has_codec_parameters()函数，用于判断AVStream中的成员变量是否都已经设置完毕。该函数在avformat_find_stream_info()中的多个地方被使用过。下面简单看一下该函数。</p><p><br /></p><h3>has_codec_parameters()</h3>has_codec_parameters()用于检查AVStream中的成员变量是否都已经设置完毕。函数的定义如下。<br /><pre class="cpp">static int has_codec_parameters(AVStream *st, const char **errmsg_ptr)
{
    AVCodecContext *avctx = st-&gt;codec;


#define FAIL(errmsg) do {                                         \
        if (errmsg_ptr)                                           \
            *errmsg_ptr = errmsg;                                 \
        return 0;                                                 \
    } while (0)


    if (   avctx-&gt;codec_id == AV_CODEC_ID_NONE
        &amp;&amp; avctx-&gt;codec_type != AVMEDIA_TYPE_DATA)
        FAIL("unknown codec");
    switch (avctx-&gt;codec_type) {
    case AVMEDIA_TYPE_AUDIO:
        if (!avctx-&gt;frame_size &amp;&amp; determinable_frame_size(avctx))
            FAIL("unspecified frame size");
        if (st-&gt;info-&gt;found_decoder &gt;= 0 &amp;&amp;
            avctx-&gt;sample_fmt == AV_SAMPLE_FMT_NONE)
            FAIL("unspecified sample format");
        if (!avctx-&gt;sample_rate)
            FAIL("unspecified sample rate");
        if (!avctx-&gt;channels)
            FAIL("unspecified number of channels");
        if (st-&gt;info-&gt;found_decoder &gt;= 0 &amp;&amp; !st-&gt;nb_decoded_frames &amp;&amp; avctx-&gt;codec_id == AV_CODEC_ID_DTS)
            FAIL("no decodable DTS frames");
        break;
    case AVMEDIA_TYPE_VIDEO:
        if (!avctx-&gt;width)
            FAIL("unspecified size");
        if (st-&gt;info-&gt;found_decoder &gt;= 0 &amp;&amp; avctx-&gt;pix_fmt == AV_PIX_FMT_NONE)
            FAIL("unspecified pixel format");
        if (st-&gt;codec-&gt;codec_id == AV_CODEC_ID_RV30 || st-&gt;codec-&gt;codec_id == AV_CODEC_ID_RV40)
            if (!st-&gt;sample_aspect_ratio.num &amp;&amp; !st-&gt;codec-&gt;sample_aspect_ratio.num &amp;&amp; !st-&gt;codec_info_nb_frames)
                FAIL("no frame in rv30/40 and no sar");
        break;
    case AVMEDIA_TYPE_SUBTITLE:
        if (avctx-&gt;codec_id == AV_CODEC_ID_HDMV_PGS_SUBTITLE &amp;&amp; !avctx-&gt;width)
            FAIL("unspecified size");
        break;
    case AVMEDIA_TYPE_DATA:
        if (avctx-&gt;codec_id == AV_CODEC_ID_NONE) return 1;
    }


    return 1;
}</pre><br /><br /><h2>estimate_timings()</h2>estimate_timings()位于avformat_find_stream_info()最后面，用于估算AVFormatContext以及AVStream的时长duration。它的代码如下所示。<br /><pre class="cpp">static void estimate_timings(AVFormatContext *ic, int64_t old_offset)
{
    int64_t file_size;


    /* get the file size, if possible */
    if (ic-&gt;iformat-&gt;flags &amp; AVFMT_NOFILE) {
        file_size = 0;
    } else {
        file_size = avio_size(ic-&gt;pb);
        file_size = FFMAX(0, file_size);
    }


    if ((!strcmp(ic-&gt;iformat-&gt;name, "mpeg") ||
         !strcmp(ic-&gt;iformat-&gt;name, "mpegts")) &amp;&amp;
        file_size &amp;&amp; ic-&gt;pb-&gt;seekable) {
        /* get accurate estimate from the PTSes */
        estimate_timings_from_pts(ic, old_offset);
        ic-&gt;duration_estimation_method = AVFMT_DURATION_FROM_PTS;
    } else if (has_duration(ic)) {
        /* at least one component has timings - we use them for all
         * the components */
        fill_all_stream_timings(ic);
        ic-&gt;duration_estimation_method = AVFMT_DURATION_FROM_STREAM;
    } else {
        /* less precise: use bitrate info */
        estimate_timings_from_bit_rate(ic);
        ic-&gt;duration_estimation_method = AVFMT_DURATION_FROM_BITRATE;
    }
    update_stream_timings(ic);


    {
        int i;
        AVStream av_unused *st;
        for (i = 0; i &lt; ic-&gt;nb_streams; i++) {
            st = ic-&gt;streams[i];
            av_dlog(ic, "%d: start_time: %0.3f duration: %0.3f\n", i,
                    (double) st-&gt;start_time / AV_TIME_BASE,
                    (double) st-&gt;duration   / AV_TIME_BASE);
        }
        av_dlog(ic,
                "stream: start_time: %0.3f duration: %0.3f bitrate=%d kb/s\n",
                (double) ic-&gt;start_time / AV_TIME_BASE,
                (double) ic-&gt;duration   / AV_TIME_BASE,
                ic-&gt;bit_rate / 1000);
    }
}</pre><br />从estimate_timings()的代码中可以看出，有3种估算方法：<br />（1）通过pts（显示时间戳）。该方法调用estimate_timings_from_pts()。它的基本思想就是读取视音频流中的结束位置AVPacket的PTS和起始位置AVPacket的PTS，两者相减得到时长信息。<br />（2）通过已知流的时长。该方法调用fill_all_stream_timings()。它的代码没有细看，但从函数的注释的意思来说，应该是当有些视音频流有时长信息的时候，直接赋值给其他视音频流。<br />（3）通过bitrate（码率）。该方法调用estimate_timings_from_bit_rate()。它的基本思想就是获得整个文件大小，以及整个文件的bitrate，两者相除之后得到时长信息。<br /><br /><h3>estimate_timings_from_bit_rate()</h3>在这里附上上述几种方法中最简单的函数estimate_timings_from_bit_rate()的代码。<br /><pre class="cpp">static void estimate_timings_from_bit_rate(AVFormatContext *ic)
{
    int64_t filesize, duration;
    int i, show_warning = 0;
    AVStream *st;


    /* if bit_rate is already set, we believe it */
    if (ic-&gt;bit_rate &lt;= 0) {
        int bit_rate = 0;
        for (i = 0; i &lt; ic-&gt;nb_streams; i++) {
            st = ic-&gt;streams[i];
            if (st-&gt;codec-&gt;bit_rate &gt; 0) {
                if (INT_MAX - st-&gt;codec-&gt;bit_rate &lt; bit_rate) {
                    bit_rate = 0;
                    break;
                }
                bit_rate += st-&gt;codec-&gt;bit_rate;
            }
        }
        ic-&gt;bit_rate = bit_rate;
    }


    /* if duration is already set, we believe it */
    if (ic-&gt;duration == AV_NOPTS_VALUE &amp;&amp;
        ic-&gt;bit_rate != 0) {
        filesize = ic-&gt;pb ? avio_size(ic-&gt;pb) : 0;
        if (filesize &gt; ic-&gt;data_offset) {
            filesize -= ic-&gt;data_offset;
            for (i = 0; i &lt; ic-&gt;nb_streams; i++) {
                st      = ic-&gt;streams[i];
                if (   st-&gt;time_base.num &lt;= INT64_MAX / ic-&gt;bit_rate
                    &amp;&amp; st-&gt;duration == AV_NOPTS_VALUE) {
                    duration = av_rescale(8 * filesize, st-&gt;time_base.den,
                                          ic-&gt;bit_rate *
                                          (int64_t) st-&gt;time_base.num);
                    st-&gt;duration = duration;
                    show_warning = 1;
                }
            }
        }
    }
    if (show_warning)
        av_log(ic, AV_LOG_WARNING,
               "Estimating duration from bitrate, this may be inaccurate\n");
}</pre><br />从代码中可以看出，该函数做了两步工作：<br />（1）如果AVFormatContext中没有bit_rate信息，就把所有AVStream的bit_rate加起来作为AVFormatContext的bit_rate信息。<br />（2）使用文件大小filesize除以bitrate得到时长信息。具体的方法是：<br /><div style="text-align:center;"><strong>AVStream-&gt;duration=(filesize*8/bit_rate)/time_base</strong></div><span style="font-family:'FangSong_GB2312';">PS：<br />1）filesize乘以8是因为需要把Byte转换为Bit<br />2）具体的实现函数是那个av_rescale()函数。x=av_rescale(a,b,c)的含义是x=a*b/c。<br />3）之所以要除以time_base，是因为AVStream中的duration的单位是time_base，注意这和AVFormatContext中的duration的单位（单位是AV_TIME_BASE，固定取值为1000000）是不一样的。</span><br /><p><br /></p><p>至此，avformat_find_stream_info()主要的函数就分析完了。</p><p><br /></p><p><strong><span style="color:#990000;">雷霄骅<br />leixiaohua1020@126.com<br />http://blog.csdn.net/leixiaohua1020</span></strong><br /></p>            </div>
                </div>
				<div style="display:none;" class="hide-article-box text-center csdn-tracking-statistics tracking-click" data-mod="popu_376">
			<a class="btn btn-red-hollow" id="btn-readmore">阅读更多</a>
		</div>
        	</article>
	
		<div class="article-bar-bottom">
				<div class="article-copyright">
			版权声明：本文为博主原创文章，未经博主允许不得转载。			https://blog.csdn.net/leixiaohua1020/article/details/44084321		</div>
						<div class="tags-box artic-tag-box">
			<span class="label">文章标签：</span>
						<a class="tag-link" href="http://so.csdn.net/so/search/s.do?q=FFmpeg&t=blog" target="_blank">FFmpeg						<a class="tag-link" href="http://so.csdn.net/so/search/s.do?q=源代码&t=blog" target="_blank">源代码						<a class="tag-link" href="http://so.csdn.net/so/search/s.do?q=AVFormatContext&t=blog" target="_blank">AVFormatContext						<a class="tag-link" href="http://so.csdn.net/so/search/s.do?q=媒体信息&t=blog" target="_blank">媒体信息						</a>
		</div>
						<div class="tags-box">
			<span class="label">个人分类：</span>
						<a class="tag-link" href="https://blog.csdn.net/leixiaohua1020/article/category/1360795"  target="_blank">FFMPEG						</a>
		</div>
						<div class="tags-box">
			<span class="label">所属专栏：</span>
						<a class="tag-link" href="https://blog.csdn.net/column/details/ffmpeg-devel.html" target="_blank">FFmpeg</a>
						</a>
		</div>
			</div>
	
	<!-- !empty($pre_next_article[0]) -->
		</div>
<script>
    $(".MathJax").remove();
</script>

<script type="text/javascript" src="https://static-blog.csdn.net/mdeditor/public/res/bower-libs/MathJax/MathJax@js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
			"HTML-CSS": {
					linebreaks: { automatic: true, width: "94%container" },
					imageFont: null
			},
			tex2jax: {
				preview: "none"
			},
			mml2jax: {
				preview: 'none'
			}
	});
</script>
<script>
	(function(){
		var btnReadmore = $("#btn-readmore");
		if(btnReadmore.length>0){
			var winH = $(window).height();
			var articleBox = $("div.article_content");
			var artH = articleBox.height();
			if(artH > winH*2){
				articleBox.css({
					'height':winH*2+'px',
					'overflow':'hidden'
				})
				btnReadmore.click(function(){
					articleBox.removeAttr("style");
					$(this).parent().remove();
				})
			}else{
				btnReadmore.parent().remove();
			}
		}
	})()
</script>                <a id="commentBox"></a>
<div class="comment-box" style="display:none;">
	  	<div class="unlogin-box text-center">
		想对作者说点什么？
		<!-- $curl 当前地址 -->
		<a href="https://passport.csdn.net/account/login?from=https://blog.csdn.net/leixiaohua1020/article/details/44084321#commentBox" class="btn btn-sm btn-red">我来说一句</a>
	</div>
			<div class="comment-list-container">
		<a id="comments"></a>
		<div class="comment-list-box">
		</div>
		<div id="commentPage" class="pagination-box d-none"></div>
		<div class="opt-box text-center">
			<button class="btn btn-sm btn-link-blue" id="btnMoreComment"></button>
		</div>
	</div>
</div>        <div class="recommend-box" style="display:none;">
            		<div class="recommend-item-box csdn-tracking-statistics" data-mod="popu_387" data-poputype="feed"  data-feed-show="false"  data-dsm="post">
		<h4 class="text-truncate">
			<a href="https://blog.csdn.net/cmengwei/article/details/44650635" target="_blank" strategy="BlogCommendFromBaidu_19">
				VLC优化（1） <em>avformat_find_stream_info</em>接口延迟降低			</a>
		</h4>
		<p class="content">
			<a href="https://blog.csdn.net/cmengwei/article/details/44650635" target="_blank" >
				VLC优化（1） <em>avformat_find_stream_info</em>接口延迟降低

http://jiya.io/page/1/





0x00 前置信息


版本:ffmp...			</a>
		</p>
		<div class="info-box d-flex align-content-center">
			<p>
				<a class="avatar" src="https://blog.csdn.net/cmengwei" title="cmengwei" target="_blank">
					<img src="https://avatar.csdn.net/D/4/A/3_cmengwei.jpg" alt="cmengwei" class="avatar-pic">
					<span class="name">cmengwei</span>
				</a>
			</p>
			<p>
				<span class="date">2015-03-26 15:33:00</span>
			</p>
			<p>
				<span class="read-num">阅读数：1028</span>
			</p>
		</div>
	</div>
					<div class="recommend-item-box csdn-tracking-statistics" data-mod="popu_387" data-poputype="feed"  data-feed-show="false"  data-dsm="post">
		<h4 class="text-truncate">
			<a href="https://blog.csdn.net/H514434485/article/details/77802382" target="_blank" strategy="BlogCommendFromBaidu_0">
				FFMEPG函数<em>avformat_find_stream_info</em>作用			</a>
		</h4>
		<p class="content">
			<a href="https://blog.csdn.net/H514434485/article/details/77802382" target="_blank" >
				现象：<em>FFMPEG</em>打开媒体文件并查看媒体文件相关信息流程如下：
avformat_open_input；
<em>avformat_find_stream_info</em>；
av_dump_format；
针对同一...			</a>
		</p>
		<div class="info-box d-flex align-content-center">
			<p>
				<a class="avatar" src="https://blog.csdn.net/H514434485" title="H514434485" target="_blank">
					<img src="https://avatar.csdn.net/3/A/4/3_h514434485.jpg" alt="H514434485" class="avatar-pic">
					<span class="name">H514434485</span>
				</a>
			</p>
			<p>
				<span class="date">2017-09-02 17:12:47</span>
			</p>
			<p>
				<span class="read-num">阅读数：592</span>
			</p>
		</div>
	</div>
								<!-- 第四范式广告开关 -->
<script>window.p4sdk_enable_recommendBox=true</script>
			
				<div class="recommend-item-box csdn-tracking-statistics" data-mod="popu_387" data-poputype="feed"  data-feed-show="false"  data-dsm="post">
		<h4 class="text-truncate">
			<a href="https://blog.csdn.net/fb731666148/article/details/44408379" target="_blank" strategy="BlogCommendFromBaidu_1">
				<em>avformat_find_stream_info</em>函数卡住问题			</a>
		</h4>
		<p class="content">
			<a href="https://blog.csdn.net/fb731666148/article/details/44408379" target="_blank" >
				问题：初始化RTSP流时，在android设备上卡住在<em>avformat_find_stream_info</em>函数，然后程序崩溃。
但其他URL没问题，且同样在代码在iOS上没问题，由于jni调试，也没看...			</a>
		</p>
		<div class="info-box d-flex align-content-center">
			<p>
				<a class="avatar" src="https://blog.csdn.net/fb731666148" title="fb731666148" target="_blank">
					<img src="https://avatar.csdn.net/9/7/7/3_fb731666148.jpg" alt="fb731666148" class="avatar-pic">
					<span class="name">fb731666148</span>
				</a>
			</p>
			<p>
				<span class="date">2015-03-18 11:48:58</span>
			</p>
			<p>
				<span class="read-num">阅读数：1811</span>
			</p>
		</div>
	</div>
					<div class="recommend-item-box csdn-tracking-statistics" data-mod="popu_387" data-poputype="feed"  data-feed-show="false"  data-dsm="post">
		<h4 class="text-truncate">
			<a href="https://blog.csdn.net/leo2007608/article/details/53421528" target="_blank" strategy="BlogCommendFromBaidu_2">
				<em>FFMPEG</em> <em>avformat_find_stream_info</em>替换			</a>
		</h4>
		<p class="content">
			<a href="https://blog.csdn.net/leo2007608/article/details/53421528" target="_blank" >
				<em>FFMPEG</em> <em>avformat_find_stream_info</em>替换前提
  因为使用<em>avformat_find_stream_info</em>接口读取一部分视音频数据并且获得一些相关的信息。耗时太长，在网上...			</a>
		</p>
		<div class="info-box d-flex align-content-center">
			<p>
				<a class="avatar" src="https://blog.csdn.net/leo2007608" title="leo2007608" target="_blank">
					<img src="https://avatar.csdn.net/1/C/7/3_leo2007608.jpg" alt="leo2007608" class="avatar-pic">
					<span class="name">leo2007608</span>
				</a>
			</p>
			<p>
				<span class="date">2016-12-01 17:09:22</span>
			</p>
			<p>
				<span class="read-num">阅读数：2675</span>
			</p>
		</div>
	</div>
					<div class="recommend-item-box csdn-tracking-statistics" data-mod="popu_387" data-poputype="feed"  data-feed-show="false"  data-dsm="post">
		<h4 class="text-truncate">
			<a href="https://blog.csdn.net/wupengqiangqinli/article/details/50683953" target="_blank" strategy="BlogCommendFromBaidu_3">
				解决 <em>ffmpeg</em> 在<em>avformat_find_stream_info</em>执行时间太长			</a>
		</h4>
		<p class="content">
			<a href="https://blog.csdn.net/wupengqiangqinli/article/details/50683953" target="_blank" >
				原文地址： http://blog.csdn.net/itpeng523/article/details/38581301




用<em>ffmpeg</em>做demux，网上很多参考文章。对于网络流，avfor...			</a>
		</p>
		<div class="info-box d-flex align-content-center">
			<p>
				<a class="avatar" src="https://blog.csdn.net/wupengqiangqinli" title="wupengqiangqinli" target="_blank">
					<img src="https://avatar.csdn.net/9/0/7/3_wupengqiangqinli.jpg" alt="wupengqiangqinli" class="avatar-pic">
					<span class="name">wupengqiangqinli</span>
				</a>
			</p>
			<p>
				<span class="date">2016-02-18 09:37:56</span>
			</p>
			<p>
				<span class="read-num">阅读数：796</span>
			</p>
		</div>
	</div>
					<div class="recommend-item-box csdn-tracking-statistics" data-mod="popu_387" data-poputype="feed"  data-feed-show="false"  data-dsm="post">
		<h4 class="text-truncate">
			<a href="https://blog.csdn.net/dancing_night/article/details/46429709" target="_blank" strategy="BlogCommendFromBaidu_4">
				<em>ffmpeg</em>源码跟踪笔记之<em>avformat_find_stream_info</em>			</a>
		</h4>
		<p class="content">
			<a href="https://blog.csdn.net/dancing_night/article/details/46429709" target="_blank" >
				1、函数介绍
位于libavformat/avformat.h：
/**
 * Read packets of a media file to get stream information. Th...			</a>
		</p>
		<div class="info-box d-flex align-content-center">
			<p>
				<a class="avatar" src="https://blog.csdn.net/dancing_night" title="dancing_night" target="_blank">
					<img src="https://avatar.csdn.net/E/8/3/3_dancing_night.jpg" alt="dancing_night" class="avatar-pic">
					<span class="name">dancing_night</span>
				</a>
			</p>
			<p>
				<span class="date">2015-06-09 17:45:06</span>
			</p>
			<p>
				<span class="read-num">阅读数：1729</span>
			</p>
		</div>
	</div>
					<div class="recommend-item-box recommend-ad-box" id="a_d_feed_0"></div>
			<script>
				var width = $("div.recommend-box").outerWidth() - 48;
				NEWS_FEED({
					w: width,
					h: 90,
					showid: 'Afihld',
					placeholderId: 'a_d_feed_0',
					inject: 'define',
					define: {
						imagePosition: 'right',
						imageBorderRadius: 0,
						imageWidth: 120,
						imageHeight: 90,
						imageFill: 'clip',
						displayImage: true,
						displayTitle: true,
						titleFontSize: 20,
						titleFontColor: '#333',
						titleFontFamily: 'Microsoft Yahei',
						titleFontWeight: 'bold',
						titlePaddingTop: 0,
						titlePaddingRight: 0,
						titlePaddingBottom: 10,
						titlePaddingLeft: 0,
						displayDesc: true,
						descFontSize: 14,
						descFontColor: '#6b6b6b',
						descFontFamily: 'Microsoft Yahei',
						paddingTop: 0,
						paddingRight: 0,
						paddingBottom: 0,
						paddingLeft: 0,
						backgroundColor: '#fff',
						hoverColor: '#ca0c16'
					}
				})
			</script>
			<div class="recommend-item-box csdn-tracking-statistics" data-mod="popu_387" data-poputype="feed"  data-feed-show="false"  data-dsm="post">
		<h4 class="text-truncate">
			<a href="https://blog.csdn.net/itpeng523/article/details/38581301" target="_blank" strategy="BlogCommendFromBaidu_5">
				解决 <em>ffmpeg</em>  在<em>avformat_find_stream_info</em>执行时间太长			</a>
		</h4>
		<p class="content">
			<a href="https://blog.csdn.net/itpeng523/article/details/38581301" target="_blank" >
				用<em>ffmpeg</em>做demux，网上很多参考文章。对于网络流，avformt_find_stream_info（）函数默认需要花费较长的时间进行流格式探测，
那么，如何减少探测时间内？ 可以通过设置AV...			</a>
		</p>
		<div class="info-box d-flex align-content-center">
			<p>
				<a class="avatar" src="https://blog.csdn.net/itpeng523" title="itpeng523" target="_blank">
					<img src="https://avatar.csdn.net/6/3/0/3_itpeng523.jpg" alt="itpeng523" class="avatar-pic">
					<span class="name">itpeng523</span>
				</a>
			</p>
			<p>
				<span class="date">2014-08-15 10:22:54</span>
			</p>
			<p>
				<span class="read-num">阅读数：11476</span>
			</p>
		</div>
	</div>
					<div class="recommend-item-box csdn-tracking-statistics" data-mod="popu_387" data-poputype="feed"  data-feed-show="false"  data-dsm="post">
		<h4 class="text-truncate">
			<a href="https://blog.csdn.net/spirit008/article/details/18546837" target="_blank" strategy="BlogCommendFromBaidu_6">
				针对<em>ffmpeg</em>做rtsp客户端时，<em>avformat_find_stream_info</em>长时间等待问题			</a>
		</h4>
		<p class="content">
			<a href="https://blog.csdn.net/spirit008/article/details/18546837" target="_blank" >
				基于<em>ffmpeg</em>2.1.1修改
在rtsp.c的sdp_parse_line函数中，case 'a'中加入对framerate和x-framerate字段的解析。


else if (av_...			</a>
		</p>
		<div class="info-box d-flex align-content-center">
			<p>
				<a class="avatar" src="https://blog.csdn.net/spirit008" title="spirit008" target="_blank">
					<img src="https://avatar.csdn.net/8/A/6/3_spirit008.jpg" alt="spirit008" class="avatar-pic">
					<span class="name">spirit008</span>
				</a>
			</p>
			<p>
				<span class="date">2014-01-20 09:21:50</span>
			</p>
			<p>
				<span class="read-num">阅读数：2018</span>
			</p>
		</div>
	</div>
					<div class="recommend-item-box csdn-tracking-statistics" data-mod="popu_387" data-poputype="feed"  data-feed-show="false"  data-dsm="post">
		<h4 class="text-truncate">
			<a href="https://blog.csdn.net/qpx0033/article/details/51290528" target="_blank" strategy="BlogCommendFromBaidu_7">
				<em>avformat_find_stream_info</em>接口延迟降低			</a>
		</h4>
		<p class="content">
			<a href="https://blog.csdn.net/qpx0033/article/details/51290528" target="_blank" >
				0x00 前置信息


版本:<em>ffmpeg</em>2.2.0
文件:vlc src/module/demux/avformat/demux.c
函数:OpenDemux
0x01 研究背景
<em>ffmpeg</em>的两个...			</a>
		</p>
		<div class="info-box d-flex align-content-center">
			<p>
				<a class="avatar" src="https://blog.csdn.net/qpx0033" title="qpx0033" target="_blank">
					<img src="https://avatar.csdn.net/8/1/A/3_qpx0033.jpg" alt="qpx0033" class="avatar-pic">
					<span class="name">qpx0033</span>
				</a>
			</p>
			<p>
				<span class="date">2016-05-01 15:11:13</span>
			</p>
			<p>
				<span class="read-num">阅读数：597</span>
			</p>
		</div>
	</div>
					<div class="recommend-item-box csdn-tracking-statistics" data-mod="popu_387" data-poputype="feed"  data-feed-show="false"  data-dsm="post">
		<h4 class="text-truncate">
			<a href="https://blog.csdn.net/lanxiaziyi/article/details/71667267" target="_blank" strategy="BlogCommendFromBaidu_8">
				<em>avformat_find_stream_info</em> 崩溃			</a>
		</h4>
		<p class="content">
			<a href="https://blog.csdn.net/lanxiaziyi/article/details/71667267" target="_blank" >
				<em>avformat_find_stream_info</em> 崩溃			</a>
		</p>
		<div class="info-box d-flex align-content-center">
			<p>
				<a class="avatar" src="https://blog.csdn.net/lanxiaziyi" title="lanxiaziyi" target="_blank">
					<img src="https://avatar.csdn.net/E/0/D/3_lanxiaziyi.jpg" alt="lanxiaziyi" class="avatar-pic">
					<span class="name">lanxiaziyi</span>
				</a>
			</p>
			<p>
				<span class="date">2017-05-11 19:00:21</span>
			</p>
			<p>
				<span class="read-num">阅读数：605</span>
			</p>
		</div>
	</div>
			            <!-- 第四范式SDK -->
<script src="https://nbrecsys.4paradigm.com/resource/js/sdk-csdn-smallflow@js" async defer></script>
            <div class="recommend-loading-box">
                <img src='https://csdnimg.cn/release/phoenix/images/feedLoading.gif'>
            </div>
            <div class="recommend-end-box">
                <p class="text-center">没有更多推荐了，<a href="https://blog.csdn.net/" class="c-blue c-blue-hover c-blue-focus">返回首页</a></p>
            </div>
        </div>
    <div style="border-bottom: dashed 1px #666;"><span style="font-size: 0.8em; font-weight: bold;">此PDF由<a style="color:#0000ff" href="http://www.github.com/spygg">spygg</a>生成,请尊重原作者版权!!!<br/>我的邮箱:liushidc@163.com</span></div> </main>
    <aside style="display: none;">
		    <div id="asideProfile" class="aside-box">
    <h3 class="aside-title">个人资料</h3>
    <div class="profile-intro d-flex">
        <div class="avatar-box d-flex justify-content-center flex-column">
            <a href="https://blog.csdn.net/leixiaohua1020">
                <img src="https://avatar.csdn.net/A/7/6/3_leixiaohua1020.jpg" class="avatar_pic">
            </a>
        </div>
        <div class="user-info d-flex justify-content-center flex-column">
            <p class="name csdn-tracking-statistics tracking-click" data-mod="popu_379">
                <a href="https://blog.csdn.net/leixiaohua1020" target="_blank" class="text-truncate" id="uid">leixiaohua1020</a>
            </p>
                    </div>
                <div class="opt-box d-flex justify-content-center flex-column">
            <span  class="csdn-tracking-statistics tracking-click" data-mod="popu_379">
                                <a class="btn btn-sm btn-red-hollow" href="https://passport.csdn.net/account/login?from=https://blog.csdn.net/leixiaohua1020/article/details/44084321" target="_self">关注</a>
                            </span>
                    </div>
            </div>
    <div class="data-info d-flex item-tiling">
                <dl class="text-center" title="373">
                        <dt><a href="https://blog.csdn.net/leixiaohua1020?t=1">原创</a></dt>
            <dd><a href="https://blog.csdn.net/leixiaohua1020?t=1"><span class="count">373</span></a></dd>
                    </dl>
        <dl class="text-center" title="14088">
            <dt>粉丝</dt>
            <dd><span class="count" id="fan">1万+</span></dd>
        </dl>
        <dl class="text-center" title="460">
            <dt>喜欢</dt>
            <dd><span class="count">460</span></dd>
        </dl>
        <dl class="text-center" title="7317">
            <dt>评论</dt>
            <dd><span class="count">7317</span></dd>
        </dl>
    </div>
    <div class="grade-box clearfix">
        <dl>
            <dt>等级：</dt>
            <dd>
                <a href="https://blog.csdn.net/home/help.html#level" title="9级,点击查看等级说明" target="_blank">
                    <svg class="icon icon-level" aria-hidden="true">
                        <use xlink:href="#csdnc-bloglevel-9"></use>
                    </svg>
                </a>
            </dd>
        </dl>
        <dl>
            <dt>访问：</dt>
            <dd title="10421201">
                1042万+            </dd>
        </dl>
        <dl>
            <dt>积分：</dt>
            <dd title="62878">
                6万+            </dd>
        </dl>
        <dl title="49">
            <dt>排名：</dt>
            <dd>49</dd>
        </dl>
    </div>
        <div class="badge-box d-flex">
        <span>勋章：</span>
                <a class="icon-badge" title="专栏达人">
            <svg class="icon" aria-hidden="true">
                <use xlink:href="#csdnc-m-columns"></use>
            </svg>
            <div class="icon-arrow"></div>
            <div class="grade-detail-box item1">
                <div class="pos-box">
                    <div class="left-box d-flex justify-content-center align-items-center flex-column">
                        <svg class="icon" aria-hidden="true">
                            <use xlink:href="#csdnc-m-columns"></use>
                        </svg>
                        <p>专栏达人</p>
                    </div>
                    <div class="right-box d-flex justify-content-center align-items-center">
                        授予成功创建个人博客专栏的用户。专栏中添加五篇以上博文即可点亮！撰写博客专栏浓缩技术精华，专栏达人就是你！
                    </div>
                </div>
            </div> 
        </a>  
                        <a class="icon-badge" title="持之以恒">
            <svg class="icon" aria-hidden="true">
                <use xlink:href="#csdnc-m-lasting"></use>
            </svg>
            <div class="icon-arrow"></div>
            <div class="grade-detail-box item2">
                <div class="pos-box">
                    <div class="left-box d-flex justify-content-center align-items-center flex-column">
                        <svg class="icon" aria-hidden="true">
                            <use xlink:href="#csdnc-m-lasting"></use>
                        </svg>
                        <p>持之以恒</p>
                    </div>
                    <div class="right-box d-flex justify-content-center align-items-center">
                        授予每个自然月内发布4篇或4篇以上原创或翻译IT博文的用户。不积跬步无以至千里，不积小流无以成江海，程序人生的精彩需要坚持不懈地积累！
                    </div>
                </div>
            </div>
        </a>
                                <a class="icon-badge" title="博客之星">
            <svg class="icon" aria-hidden="true">
                <use xlink:href="#csdnc-m-blogstar-l"></use>
            </svg>
            <div class="icon-arrow"></div>
            <div class="grade-detail-box item4">
                <div class="pos-box">
                    <div class="left-box d-flex justify-content-center align-items-center flex-column">
                        <svg class="icon" aria-hidden="true">
                            <use xlink:href="#csdnc-m-blogstar-l"></use>
                        </svg>
                        <p>博客之星</p>
                    </div>
                    <div class="right-box d-flex justify-content-center align-items-center">
                        授予通过"CSDN博客之星评选"中脱颖而出的十大博客之星称号的用户。
                    </div>
                </div>
            </div>
        </a>   
            </div>
    </div>		    <div class="csdn-tracking-statistics mb8 box-shadow" data-pid="blog" data-mod="popu_4" style="height:250px;">
    <div class="aside-content text-center" id="cpro_u2734133">
        <!-- 投放代码 -->
        <script type="text/javascript" src="//cee1.iteye.com/lgyyovfyh@js"></script>
    </div>
</div>
		    <!--自定义模块-->
<div id="asideCustom26787557" class="aside-box custom-box">
    <h3 class="aside-title">关于我</h3>
    <div class="aside-content clearfix">
        姓名：雷霄骅<br>
网名：leixiaohua1020<br>
本科：<br>
中国传媒大学-广播电视工程<br>
硕士：<br>
中国传媒大学-数字电视技术<br>
博士：<br>
中国传媒大学-数字视频技术<br>
Email：<br>
leixiaohua1020@126.com<br>
QQ：<br>
494085803<br>
<br>
[注1：QQ消息较多，难以一一回复，见谅]<br>
[注2：CSDN私信功能使用很少，有问题可以直接在博客评论处留言]<br>
<br>
奖项：<br>
<a href="http://vote.blog.csdn.net/Blogstar2014/List">2014年度 - CSDN博客之星</a><br>
<a href="https://mvp.microsoft.com/en-us/mvp/Xiaohua%20Lei-5001392">2015年度 - 微软MVP</a><br>
<a href="http://bss.csdn.net/m/topic/community_star/index">2015年度 - CSDN博客之星</a><br>
简介：<br>
主要从事与广播电视有关的视音频技术的研究。包括视音频质量评价，视音频编解码，流媒体，媒资检索等。
<br>    </div>
</div>
		    <div id="asideNewArticle" class="aside-box">
    <h3 class="aside-title">最新文章</h3>
    <div class="aside-content">
        <ul class="inf_list clearfix csdn-tracking-statistics tracking-click" data-mod="popu_382">
                        <li class="clearfix">
                <a href="https://blog.csdn.net/leixiaohua1020/article/details/51187668" target="_blank">[投稿] Speex回声消除原理深度解析</a>
            </li>
                        <li class="clearfix">
                <a href="https://blog.csdn.net/leixiaohua1020/article/details/50789619" target="_blank">[投稿]房间声学原理与Schroeder混响算法实现</a>
            </li>
                        <li class="clearfix">
                <a href="https://blog.csdn.net/leixiaohua1020/article/details/50789503" target="_blank">[投稿]一个频域语音降噪算法实现及改进方法</a>
            </li>
                        <li class="clearfix">
                <a href="https://blog.csdn.net/leixiaohua1020/article/details/50618190" target="_blank">最简单的基于FFmpeg的AVfilter的例子-纯净版</a>
            </li>
                        <li class="clearfix">
                <a href="https://blog.csdn.net/leixiaohua1020/article/details/50535230" target="_blank">视音频数据处理入门：UDP-RTP协议解析</a>
            </li>
                    </ul>
    </div>
</div>
		    <div id="asideColumn" class="aside-box">
    <h3 class="aside-title">博主专栏</h3>
    <div class="aside-content">
        <ul class="column-box csdn-tracking-statistics tracking-click" data-mod="popu_520" >
                            <li class="clearfix">
                    <div class="img-box float-left">
                        <a class="d-flex align-items-center" href="https://blog.csdn.net/column/details/videoquality.html">
                            <img src="https://img-blog.csdn.net/20151123175555036?imageView2/5/w/120/h/120" alt="">
                        </a>
                    </div>
                    <div class="info">
                        <p class="title"><a href="https://blog.csdn.net/column/details/videoquality.html">视频质量评价</a></p>
                        <div class="data">阅读量：<span>434203</span><span class="count">41 篇</span></div>
                    </div>
                </li>
                            <li class="clearfix">
                    <div class="img-box float-left">
                        <a class="d-flex align-items-center" href="https://blog.csdn.net/column/details/osmedia.html">
                            <img src="https://img-blog.csdn.net/20151123175559974?imageView2/5/w/120/h/120" alt="">
                        </a>
                    </div>
                    <div class="info">
                        <p class="title"><a href="https://blog.csdn.net/column/details/osmedia.html">开源多媒体项目源代码分析</a></p>
                        <div class="data">阅读量：<span>1158961</span><span class="count">91 篇</span></div>
                    </div>
                </li>
                            <li class="clearfix">
                    <div class="img-box float-left">
                        <a class="d-flex align-items-center" href="https://blog.csdn.net/column/details/ffmpeg-devel.html">
                            <img src="https://img-blog.csdn.net/20151123175857395?imageView2/5/w/120/h/120" alt="">
                        </a>
                    </div>
                    <div class="info">
                        <p class="title"><a href="https://blog.csdn.net/column/details/ffmpeg-devel.html">FFmpeg</a></p>
                        <div class="data">阅读量：<span>4852475</span><span class="count">135 篇</span></div>
                    </div>
                </li>
                    </ul>
    </div>
    </div>
		    <div id="asideArchive" class="aside-box flexible-box">
    <h3 class="aside-title">归档</h3>
    <div class="aside-content">
        <ul class="archive-list">
                        <!--归档统计-->
            <li>
                <a href="https://blog.csdn.net/leixiaohua1020/article/month/2016/04">
                    2016年4月                    <span class="count float-right">1篇</span>
                </a>
            </li>
                        <!--归档统计-->
            <li>
                <a href="https://blog.csdn.net/leixiaohua1020/article/month/2016/03">
                    2016年3月                    <span class="count float-right">2篇</span>
                </a>
            </li>
                        <!--归档统计-->
            <li>
                <a href="https://blog.csdn.net/leixiaohua1020/article/month/2016/02">
                    2016年2月                    <span class="count float-right">1篇</span>
                </a>
            </li>
                        <!--归档统计-->
            <li>
                <a href="https://blog.csdn.net/leixiaohua1020/article/month/2016/01">
                    2016年1月                    <span class="count float-right">7篇</span>
                </a>
            </li>
                        <!--归档统计-->
            <li>
                <a href="https://blog.csdn.net/leixiaohua1020/article/month/2015/12">
                    2015年12月                    <span class="count float-right">1篇</span>
                </a>
            </li>
                        <!--归档统计-->
            <li>
                <a href="https://blog.csdn.net/leixiaohua1020/article/month/2015/11">
                    2015年11月                    <span class="count float-right">7篇</span>
                </a>
            </li>
                        <!--归档统计-->
            <li>
                <a href="https://blog.csdn.net/leixiaohua1020/article/month/2015/08">
                    2015年8月                    <span class="count float-right">4篇</span>
                </a>
            </li>
                        <!--归档统计-->
            <li>
                <a href="https://blog.csdn.net/leixiaohua1020/article/month/2015/07">
                    2015年7月                    <span class="count float-right">17篇</span>
                </a>
            </li>
                        <!--归档统计-->
            <li>
                <a href="https://blog.csdn.net/leixiaohua1020/article/month/2015/06">
                    2015年6月                    <span class="count float-right">6篇</span>
                </a>
            </li>
                        <!--归档统计-->
            <li>
                <a href="https://blog.csdn.net/leixiaohua1020/article/month/2015/05">
                    2015年5月                    <span class="count float-right">12篇</span>
                </a>
            </li>
                        <!--归档统计-->
            <li>
                <a href="https://blog.csdn.net/leixiaohua1020/article/month/2015/04">
                    2015年4月                    <span class="count float-right">7篇</span>
                </a>
            </li>
                        <!--归档统计-->
            <li>
                <a href="https://blog.csdn.net/leixiaohua1020/article/month/2015/03">
                    2015年3月                    <span class="count float-right">25篇</span>
                </a>
            </li>
                        <!--归档统计-->
            <li>
                <a href="https://blog.csdn.net/leixiaohua1020/article/month/2015/02">
                    2015年2月                    <span class="count float-right">7篇</span>
                </a>
            </li>
                        <!--归档统计-->
            <li>
                <a href="https://blog.csdn.net/leixiaohua1020/article/month/2015/01">
                    2015年1月                    <span class="count float-right">11篇</span>
                </a>
            </li>
                        <!--归档统计-->
            <li>
                <a href="https://blog.csdn.net/leixiaohua1020/article/month/2014/12">
                    2014年12月                    <span class="count float-right">10篇</span>
                </a>
            </li>
                        <!--归档统计-->
            <li>
                <a href="https://blog.csdn.net/leixiaohua1020/article/month/2014/11">
                    2014年11月                    <span class="count float-right">9篇</span>
                </a>
            </li>
                        <!--归档统计-->
            <li>
                <a href="https://blog.csdn.net/leixiaohua1020/article/month/2014/10">
                    2014年10月                    <span class="count float-right">20篇</span>
                </a>
            </li>
                        <!--归档统计-->
            <li>
                <a href="https://blog.csdn.net/leixiaohua1020/article/month/2014/09">
                    2014年9月                    <span class="count float-right">5篇</span>
                </a>
            </li>
                        <!--归档统计-->
            <li>
                <a href="https://blog.csdn.net/leixiaohua1020/article/month/2014/08">
                    2014年8月                    <span class="count float-right">7篇</span>
                </a>
            </li>
                        <!--归档统计-->
            <li>
                <a href="https://blog.csdn.net/leixiaohua1020/article/month/2014/07">
                    2014年7月                    <span class="count float-right">2篇</span>
                </a>
            </li>
                        <!--归档统计-->
            <li>
                <a href="https://blog.csdn.net/leixiaohua1020/article/month/2014/06">
                    2014年6月                    <span class="count float-right">8篇</span>
                </a>
            </li>
                        <!--归档统计-->
            <li>
                <a href="https://blog.csdn.net/leixiaohua1020/article/month/2014/05">
                    2014年5月                    <span class="count float-right">10篇</span>
                </a>
            </li>
                        <!--归档统计-->
            <li>
                <a href="https://blog.csdn.net/leixiaohua1020/article/month/2014/04">
                    2014年4月                    <span class="count float-right">1篇</span>
                </a>
            </li>
                        <!--归档统计-->
            <li>
                <a href="https://blog.csdn.net/leixiaohua1020/article/month/2014/02">
                    2014年2月                    <span class="count float-right">5篇</span>
                </a>
            </li>
                        <!--归档统计-->
            <li>
                <a href="https://blog.csdn.net/leixiaohua1020/article/month/2014/01">
                    2014年1月                    <span class="count float-right">14篇</span>
                </a>
            </li>
                        <!--归档统计-->
            <li>
                <a href="https://blog.csdn.net/leixiaohua1020/article/month/2013/12">
                    2013年12月                    <span class="count float-right">21篇</span>
                </a>
            </li>
                        <!--归档统计-->
            <li>
                <a href="https://blog.csdn.net/leixiaohua1020/article/month/2013/11">
                    2013年11月                    <span class="count float-right">71篇</span>
                </a>
            </li>
                        <!--归档统计-->
            <li>
                <a href="https://blog.csdn.net/leixiaohua1020/article/month/2013/10">
                    2013年10月                    <span class="count float-right">161篇</span>
                </a>
            </li>
                        <!--归档统计-->
            <li>
                <a href="https://blog.csdn.net/leixiaohua1020/article/month/2013/09">
                    2013年9月                    <span class="count float-right">101篇</span>
                </a>
            </li>
                        <!--归档统计-->
            <li>
                <a href="https://blog.csdn.net/leixiaohua1020/article/month/2013/08">
                    2013年8月                    <span class="count float-right">1篇</span>
                </a>
            </li>
                        <!--归档统计-->
            <li>
                <a href="https://blog.csdn.net/leixiaohua1020/article/month/2013/06">
                    2013年6月                    <span class="count float-right">2篇</span>
                </a>
            </li>
                        <!--归档统计-->
            <li>
                <a href="https://blog.csdn.net/leixiaohua1020/article/month/2013/03">
                    2013年3月                    <span class="count float-right">2篇</span>
                </a>
            </li>
                    </ul>
    </div>
        <p class="text-center">
        <a class="btn btn-link-blue flexible-btn" data-fbox="aside-archive">展开</a>
    </p>
    </div>
		    <div id="asideNewComments" class="aside-box">
    <h3 class="aside-title">最新评论</h3>
    <div class="aside-content">
        <ul class="newcomment-list">
                        <li>
                <a class="title text-truncate" target="_blank" href="https://blog.csdn.net/leixiaohua1020/article/details/15811977#comments">[总结]FFMPEG视音频编解码零...</a>
                <p class="comment">
                    <a href="https://my.csdn.net/tanhuifang520" class="user-name" target="_blank">tanhuifang520</a>：含着敬畏的心情又看了遍这个文章                </p>
            </li>
                        <li>
                <a class="title text-truncate" target="_blank" href="https://blog.csdn.net/leixiaohua1020/article/details/42105049#comments">最简单的基于librtmp的示例：...</a>
                <p class="comment">
                    <a href="https://my.csdn.net/qq_32245927" class="user-name" target="_blank">qq_32245927</a>：[reply]hjl19901012[/reply]
你们的是哪里有问题呢                </p>
            </li>
                        <li>
                <a class="title text-truncate" target="_blank" href="https://blog.csdn.net/leixiaohua1020/article/details/46754977#comments">视频编码器评测系统：VideoCo...</a>
                <p class="comment">
                    <a href="https://my.csdn.net/tqs_1220" class="user-name" target="_blank">tqs_1220</a>：天妒英才                </p>
            </li>
                        <li>
                <a class="title text-truncate" target="_blank" href="https://blog.csdn.net/leixiaohua1020/article/details/38284961#comments">FFmpeg获取DirectSho...</a>
                <p class="comment">
                    <a href="https://my.csdn.net/a137748099" class="user-name" target="_blank">a137748099</a>：[reply]liangqingzhi[/reply]
大佬，有的电脑使用regsvr32注册不成...                </p>
            </li>
                        <li>
                <a class="title text-truncate" target="_blank" href="https://blog.csdn.net/leixiaohua1020/article/details/15811977#comments">[总结]FFMPEG视音频编解码零...</a>
                <p class="comment">
                    <a href="https://my.csdn.net/qq_17276615" class="user-name" target="_blank">qq_17276615</a>：每次视频编解码都会搜到你的文章，感谢您给我们这些菜鸡一些指引。谢谢！                </p>
            </li>
                    </ul>
    </div>
</div>
		<div id="asideFooter">
			
		<div class="aside-box">
						<script type="text/javascript" src="//cee1.iteye.com/avneunkwb@js"></script>
					</div>
				<div class="aside-box">
			<div class="persion_article">
			</div>
		</div>
	</div>
</aside>
<script src="https://csdnimg.cn/pubfooter/js/publib_footer-1.0.3@js" data-isfootertrack="false" type="text/javascript"></script>
<script>
	$("a.flexible-btn").click(function(){
		$(this).parents('div.aside-box').removeClass('flexible-box');
		$(this).remove();
	})
</script>
</div>
<div class="mask-dark"></div>
<div class="pulllog-box" style="display: none;">
	<div class="pulllog clearfix">
		<span class="text float-left">加入CSDN，享受更精准的内容推荐，与500万程序员共同成长！</span>
		<div class="pulllog-btn float-right clearfix">
            <button class="pulllog-login float-left csdn-tracking-statistics tracking-click" data-mod="popu_557">
                登录
            </button>
            <div class="pulllog-sigin float-left csdn-tracking-statistics tracking-click" data-mod="popu_558">
                <a href="https://passport.csdn.net/account/mobileregister" target="_blank">注册</a>
            </div>
            <button class="btn-close">
                <svg class="icon" aria-hidden="true">
                    <use xlink:href="#csdnc-times"></use>
                </svg>
            </button>
		</div>
	</div>
</div>
<div id="loginWrap" style="display:none"></div>
<div class="tool-box">
	<ul class="meau-list">
		<li>
			<button class="btn-like " title="点赞">
				<svg class="icon active" aria-hidden="true">
					<use xlink:href="#csdnc-thumbsup-ok"></use>
				</svg><svg class="icon no-active" aria-hidden="true">
					<use xlink:href="#csdnc-thumbsup"></use>
				</svg>
				<p>15</p>
			</button>
		</li>
		<li class="toc-container-box" id="liTocBox">
			<button class="btn-toc" title="目录">
				<svg class="icon" aria-hidden="true">
					<use xlink:href="#csdnc-contents"></use>
				</svg><br>目录
			</button>
			<div class="toc-container">
				<div class="pos-box">
					<div class="icon-arrow"></div>
					<div class="scroll-box">
						<div class="toc-box"></div>
					</div>
				</div>
				<div class="opt-box">
					<button class="btn-opt prev nomore" title="向上">
						<svg class="icon" aria-hidden="true">
							<use xlink:href="#csdnc-chevronup"></use>
						</svg>
					</button>
					<button class="btn-opt next">
						<svg class="icon" aria-hidden="true">
							<use xlink:href="#csdnc-chevrondown"></use>
						</svg>
					</button>
				</div>
			</div>
		</li>
		<li>
			<button class="btn-bookmark" title="收藏">
				<svg class="icon active" aria-hidden="true">
					<use xlink:href="#csdnc-bookmark-ok"></use>
				</svg><svg class="icon no-active" aria-hidden="true">
					<use xlink:href="#csdnc-bookmark"></use>
				</svg><br>收藏
			</button>
		</li>
		<li>
			<a class="btn-comments" title="评论" href="#commentBox">
				<svg class="icon" aria-hidden="true">
					<use xlink:href="#csdnc-comments"></use>
				</svg><br>评论
			</a>
		</li>
				<li class="bdsharebuttonbox">
			<a class="btn-comments bds_weixin" data-cmd="weixin" title="微信分享">
				<svg class="icon" aria-hidden="true">
					<use xlink:href="#csdnc-wechat"></use>
				</svg><br>微信
			</a>
		</li>
		<li class="bdsharebuttonbox">
			<a class="btn-comments bds_tsina" data-cmd="tsina" title="微博分享">
				<svg class="icon" aria-hidden="true">
					<use xlink:href="#csdnc-weibo"></use>
				</svg><br>微博
			</a>
		</li>
		<li class="bdsharebuttonbox">
			<a class="btn-comments bds_qzone" data-cmd="qzone" title="QQ分享">
				<svg class="icon" aria-hidden="true">
					<use xlink:href="#csdnc-qq"></use>
				</svg><br>QQ
			</a>
		</li>
	</ul>
</div>
<script>window._bd_share_config = { "common": { "bdSnsKey": {}, "bdText": "", "bdMini": "1", "bdMiniList": false, "bdPic": "", "bdStyle": "0", "bdSize": "16" }, "share": {} }; with (document) 0[(getElementsByTagName('head')[0] || body).appendChild(createElement('script')).src = 'https://csdnimg.cn/static/api/js/share@js?v=89860594'];</script>
<script>
    var recommendCount = 10;
    recommendCount = recommendCount > 1 ? (recommendCount + (recommendCount>6 ? 2 : 1)) : recommendCount;
    var articleTit = "FFmpeg源代码简单分析：avformat_find_stream_info()";
    var ChannelId = 16;
    var articleId = "44084321";
    var commentscount = 6;
    var islock = false;
    var curentUrl = "https://blog.csdn.net/leixiaohua1020/article/details/44084321";
    var myUrl = "https://my.csdn.net/";
    //1禁止评论，2正常
    var commentAuth = 2;
    //百度搜索
    var baiduKey = "ffmpeg+avformat_find_stream_info";
    var needInsertBaidu = true;
</script>
<script src="https://csdnimg.cn/public/sandalstrap/1.3/js/sandalstrap.min@js"></script>
<script src="https://csdnimg.cn/release/phoenix/vendor/pagination/paging@js"></script>

<script>
    GoTop({
        right: 8,
        hasReport: true,
        reportFun: function() {
            showReport(false,"FFmpeg源代码简单分析：avformat_find_stream_info()");
        }
    })
</script>
<script src="https://csdnimg.cn/release/phoenix/template/js/common-bd54b21308.min@js"></script>
<script src="https://csdnimg.cn/release/phoenix/template/js/detail-effe72036e.min@js"></script>
<script src="https://csdnimg.cn/release/phoenix/themes/skin3-template/skin3-template-46c7bd3d86.min@js"></script>
<script src="https://csdnimg.cn/search/baidu_search-1.1.2@js?v=201802071056&autorun=true&install=true&keyword=ffmpeg+avformat_find_stream_info"  type="text/javascript"></script>
</body>
<div class="box-box-default" style="display:none;">
    <a class="btn-remove">
        关闭
    </a>
    <script type="text/javascript" src="//cee1.iteye.com/mhzzjepzz@js"></script>
</div>
<div class="box-box-large" style="display:none;">
    <a class="btn-remove">
        关闭
    </a>
    <script type="text/javascript" src="//cee1.iteye.com/idvveasfs@js"></script>
</div>
</html>